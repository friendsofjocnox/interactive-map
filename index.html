<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Pangaea Turn RTS</title>
</head>
<body>

<h2>Pangaea Turn-Based RTS</h2>
<button onclick="moveUnit()">Move Blue Unit</button>

<script>

const owner = "YOUR_GITHUB_USERNAME";
const repo = "pangea-rts";
const path = "game-state.json";
const token = "YOUR_PERSONAL_ACCESS_TOKEN";

let state = null;
let sha = null;

async function loadState() {
    const res = await fetch(
        `https://api.github.com/repos/${owner}/${repo}/contents/${path}`
    );

    const data = await res.json();
    sha = data.sha;

    state = JSON.parse(atob(data.content));
    console.log("Loaded state:", state);
}

async function moveUnit() {

    state.teams.blue.units[0].x += 20;
    state.turn += 1;

    const content = btoa(JSON.stringify(state, null, 2));

    await fetch(
        `https://api.github.com/repos/${owner}/${repo}/contents/${path}`,
        {
            method: "PUT",
            headers: {
                "Authorization": `token ${token}`,
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                message: "Player move",
                content: content,
                sha: sha
            })
        }
    );

    await loadState();
}

loadState();
setInterval(loadState, 5000);

</script>
</body>
</html>
